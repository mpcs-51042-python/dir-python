{"title":"Inheritance","markdown":{"headingText":"Inheritance","containsRefs":false,"markdown":"\n## Motivations\n\nLet's say we're building an application that tracks students.\n\n\n```{python}\nclass Student:\n\n    # this is a class-level variable\n    # instead of each instance having its own copy\n    # the variable is shared among all `Student`\n    next_id_counter = 1\n    \n    def __init__(self, name):\n        # assign each student a unique id\n        # note use of Student. not self.\n        self.id = Student.next_id_counter\n        Student.next_id_counter += 1\n        \n        self.name = name\n        self.year = 1\n        self.major = \"Undeclared\"\n        self.course_grades = {}\n        self.extracurriculars = []\n        \n    def add_grade(self, course_name, grade):\n        self.course_grades[course_name] = grade\n    \n    @property\n    def gpa(self):\n        grade_pts = {\"A\":4.0, \"A-\":3.7, \"B+\":3.3, \"B\":3.0, \"B-\":2.7, \"C+\":2.3, \"C\":2.0, \"C-\":1.7, \"D+\":1.3, \"D\":1.0, \"F\":0.0} \n        if len(self.course_grades) == 0:\n            return 0\n        return sum(grade_pts[g] for g in self.course_grades.values()) / len(self.course_grades)\n    \n    def __repr__(self):\n        return f\"Student(name={self.name}, id={self.id}, gpa={self.gpa})\"\n```\n\n```{python}\n#| tags: []\ns1 = Student(\"Adam\")\ns2 = Student(\"Beth\")\ns2.add_grade(\"Programming Python\", \"A\")\ns2.add_grade(\"Discrete Math\", \"B+\")\n```\n\n```{python}\n#| tags: []\nprint(s1)\nprint(s2)\n```\n\nPerhaps we want to add `Alumni` to our application.\n\nAn alum will have some things in common with students:\n\n- They still have a name.\n- We want to remember their major.\n- We'll still want to keep track of their grades/GPA.\n\nWe now also:\n\n- Want to record their year of graduation.\n- No longer want to allow grades to be recorded.\n- Want to be able to calculate how long ago they graduated.\n- When displaying them, we want to display their graduation year.\n\n**How to implement?**\n\nWe *could* copy `student.py` and rename to `alum.py` and rename the class as needed.\n\n**But copying & pasting is generally a bad idea!**\n\nWe'd need to fix bugs & add features in both classes separately.\n\nA new feature in `Student` would need to be copied over to `Alum`, this will quickly get messy.\n\n## Inheritance in Python\n\nInstead we will use **inheritance**, which allows us to create a new class from an existing one.  The new class inherits the attributes and methods from the parent.\n\n- **superclass**, **parent**, or **base** class: The pre-existing class.\n- **subclass**, **child**, or **derived** class: The new class that inherits the code (attributes & methods) of another class.\n\nSubclasses can extend/modify the functionality of superclasses.\n\nSyntax:\n\n```python\nclass Subclass(Superclass):\n    pass\n```\n\nFor example:\n\n```python\nclass Alum(Student):\n    pass\n```\n\nAt this point, `Alum` is a new class with the exact same implementation as `Student`.\n\nTypically we'll want to add new instance & class variables, methods, etc.\n\nNewly defined features will only apply to instances of `Alum`\n\nIt is possible to override parent class behavior, or rely on parent behavior, whichever is needed.\n\n### Adding & Overriding Behavior\n\n```{python}\n#| tags: []\nclass Alum(Student):\n    def __init__(self, name, grad_year):\n        # call Student's constructor, which contains id logic\n        super().__init__(name)\n        self.graduation_year = grad_year\n        \n    # new behavior\n    def years_since_graduation(self, now):\n        return now - self.graduation_year\n    \n    # overrides parent's add_grade\n    def add_grade(self, course_name, grade):\n        raise NotImplementedError(\"cannot add grades to Alum\")\n        #print(\"Sorry, you cannot add grades to Alums\")\n        # we choose not call super().add_grade here\n    \n    # overrides parent's __repr__\n    def __repr__(self):\n        #return f\"Alum(name={self.name}, id={self.id}, gpa={self.gpa}, graduated={self.graduation_year})\"\n        string = super().__repr__()\n        string += \" is an alum\"\n        return string\n```\n\n```{python}\nalum1 = Alum(\"Charlie\", 2016)\nprint(alum1)\nprint(alum1.years_since_graduation(2022), \"years since graduation\")\n#alum1.add_grade(\"Python\", \"B\")\nalum1.gpa\n```\n\n```{python}\nalum2 = Alum(\"Charlie\", 2016)\n```\n\n### super()\n\nAllows direct access to parent class(es).\n\nMany different ways to be called, but for our purposes we will stick to `super().method_name()` to access parent implementation of `method_name()`\n\n### issubclass & isinstance\n\n- `isinstance(object, class_type)` - Check if an object is of an instance.\n- `issubclass(class_type, class_type2)` - Check if a type is a subclass of another type.\n\n```{python}\nisinstance(7, int)\n```\n\n```{python}\n# same as?\ntype(7) == int\n```\n\n```{python}\ntype(7) == object\n```\n\n```{python}\nisinstance(7,  object)\n```\n\n```{python}\n# isinstance checks the inheritance hierarchy \nisinstance(alum2, object)\n```\n\n```{python}\ntype(alum2) == Student\n```\n\n```{python}\nisinstance([1, 2, 3], list)\n```\n\n```{python}\ns1 = Student(\"Sarah\")\nisinstance(s1, Student)\n```\n\n```{python}\n# child classes are instances of parent types\nalum1 = Alum(\"Charlie\", 2016)\nisinstance(alum1, Student)\n```\n\n```{python}\n# but not vice-versa\nisinstance(s1, Alum)\n```\n\n```python\n# INCORRECT: issubclass takes class names, not instances\nissubclass(alum1, Student)\n\n# Instead\nissubclass(Alum, Student)\n```\n\n### `object`\n\nEvery object derives from a base class named `object`.\n\n```python\nclass Point:\n    def __init__(self, x, y):\n        self.x = y\n\n# Same as: \n\nclass Point(object):\n    def __init__(self, x, y):\n        self.x = y\n        self.y = y\n```\n\n### MRO\n\nWhen we call a function, Python walks up the chain of parent classes to determine the first one that has the method defined.\n\nThis is called the **method resolution order**.\n\n```{python}\nhelp(Alum)\n```\n\n```{python}\nAlum.__mro__\n```\n\n```{python}\nhelp(super)\n```\n\n## Abstract Base Classes\n\nSometimes we want to define a class that can't be instantiated directly, but is intended to be inherited from.\n\nThese are known as **abstract classes**.  This helps us define an interface, which contains a collection of methods that the **concrete class** must implement.\n\n\n```{python}\ndef print_dot_prod(v1, v2):\n    \"\"\" prints dot product between two vectors \"\"\"\n    print(v1.dot_product(v2))\n```\n\nIf we want this  method to be polymorphic for vectors of multiple dimensions, such as:\n\n```{python}\nclass Vec2:\n    def __init__(self,x,y):\n        self.x = x\n        self.y = y  \n\n    def dot_product(self, other):\n        ...\n        \nclass Vec3:\n    def __init__(self,x,y,z):\n        self.x = x\n        self.y = y  \n        self.z = z \n\n    def dot(self, other):\n        ...\n```\n\nWe can force that these types implement an interface (i.e., an abstract base class) such that we can guarantee that objects we pass to ``print_dot_prod`` will always work by forcing them to implement a ``dot_product`` method. \n\nWe will define an abstract class called ``Vector`` that has only the required method: \n\n`` def dot_product(self, other) `` \n\n```{python}\n#| tags: []\nfrom abc import ABC, abstractmethod\n\nclass Vector(ABC):\n    # an unimplemented method\n    @abstractmethod\n    def dot_product(self, other):\n        pass\n\n    # demonstrate we can have a normal method\n    def print_x(self):\n        print(self.x)\n    \n```\n\n```{python}\n# we can't instantiate abstract classes\ntry:\n    v = Vector()\nexcept Exception as e:\n    print(repr(e))\n```\n\n```{python}\nclass Vec2(Vector):\n    def __init__(self, x, y):\n        self.x = x\n        self.y = y  \n        \n    def dot_product(self, other): \n        return self.x * other.x + self.y * other.y\n        \nclass Vec3(Vector):\n    def __init__(self, x, y, z):\n        self.x = x\n        self.y = y  \n        self.z = z \n        \n    def dot_product(self, other): \n        return self.x * other.x + self.y * other.y + self.z * other.z\n```\n\nNow `print_dot_prod` works:\n\n```{python}\n# Vec2 and Vec3 objects are instances of Vector since their classes \n# inherit from the Vector ABC.\nv2a = Vec2(1,2)\nv2b = Vec2(3,4)\nv3a = Vec3(6,7,3)\nv3b = Vec3(1,2,3)\n\nprint(isinstance(v2a, Vec2)) \nprint(isinstance(v2a, Vector)) \nprint(\"----\")\nprint(isinstance(v3a, Vec3)) \nprint(isinstance(v3a, Vector))\n```\n\n```{python}\nv2a.print_x()\n```\n\n```{python}\nprint_dot_prod(v2a, v2b)\n```\n\n```{python}\nprint_dot_prod(v3a, v3b)\n```\n\n## Dataclasses\n\nPython 3.7 added `dataclasses` as a handy way to create classes that are mostly responsible for representing data.\nThese classes often have few or no methods defined.\n\n```{python}\nfrom dataclasses import dataclass\n\n@dataclass\nclass InventoryItem:\n    \"\"\"Class for keeping track of an item in inventory.\"\"\"\n    name: str\n    unit_price: float\n    quantity_on_hand: int = 0\n\n    def total_cost(self) -> float:\n        return self.unit_price * self.quantity_on_hand\n\n# class decorator!\n# similar concept, much harder to write\n# \n# InventoryItem = dataclass(InventoryItem)\n```\n\n\n```{python}\nwrench = InventoryItem(\"Wrench\", 12.95, 10)\nhammer = InventoryItem(\"Hammer\", 16, 8)\nnails = InventoryItem(\"Nails\", 0.03, 1000)\nsaw = InventoryItem(\"Saw\", 99)\nsaw2 = InventoryItem(\"Saw\", 99)\n```\n\n```{python}\nsaw == saw2\n```\n\nDataclasses get an automatic `__init__`, `__repr__`, `__eq__`, and several other helpful options.  (Even more is possible via the decorator: https://docs.python.org/3/library/dataclasses.html)\n\n```{python}\n#| tags: []\nnails.total_cost()\n```\n\nBeyond this, additional methods/staticmethods/etc. can be defined in the usual way.\n\nThis syntax uses Python's type-hinting, and if you're looking to use it you'll want to get familiar with the rules\naround complex types: <https://docs.python.org/3/library/typing.html>\n\n```{python}\n# instead of returning tuples and \n# remembering the positional order, can instead\n@dataclass\nclass RetType:\n    data: list[int]\n    counter: int\n\ndef fn():\n    return RetType([], counter)\n```\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["include-code-files"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.26","number-depth":1,"theme":"yeti"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}